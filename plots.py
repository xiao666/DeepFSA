import numpy as np
import matplotlib.pyplot as plt


##############microblogs

#New validation
dict_new={'val_loss': [0.13962151180295385, 0.11346031217014088, 0.099031896187978627, 0.093141718734713164, 0.095430351706112138, 0.093117033646387209, 0.088326943797223709, 0.086973949740914741, 0.092107388289535741, 0.087897514595704926, 0.090869172706323512, 0.091278853486565989, 0.088521127227474655, 0.094524469621041246], 'val_cos': [0.44200283569448134, 0.56872830425991727, 0.64387368104037113, 0.66238849233178532, 0.66443555355072026, 0.66029909779043761, 0.6731046319007874, 0.68360380775788254, 0.67009942110847021, 0.66876019309548773, 0.66887904826332545, 0.66466780059477859, 0.66914560444214766, 0.6526485604398391], 'loss': [0.15415594472604641, 0.11176338853204952, 0.064711117656791911, 0.048819306273670759, 0.037335189563386578, 0.030562697109930655, 0.025135863484705194, 0.023427340673173175, 0.02134256437420845, 0.019506777603836619, 0.017347160704872189, 0.015205485505216262, 0.014828229509294032, 0.013441040016272488], 'cos': [0.29147180897348068, 0.63755909555098589, 0.80176657227908865, 0.86106852783876309, 0.89592486900441792, 0.91464522726395547, 0.92993539010777193, 0.93426724391825056, 0.93874557859757368, 0.94463650338789995, 0.95041030014262484, 0.95462977956323058, 0.95545269180746639, 0.9592289707239936]}
#14 select 8+5+1
new_val_loss= [0.13891369209570043, 0.11796048178392297, 0.096025291435858778, 0.095444008970961849, 0.090515873887959647, 0.089379079026334421, 0.092327630519866949,  0.087118696114596203, 0.088105054823791274, 0.08969211587134529, 0.090008397663340844, 0.090054811449611888,0.09129379207597059, 0.093332453948609964]

dict_last={'val_loss': [0.16027949435134378, 0.15101569380507962, 0.14235669817371993, 0.13658957554951723, 0.13238477979033661, 0.12905983384745548, 0.12679268194536117, 0.12479573981812979, 0.12322121571458557, 0.12184970306058975, 0.12074530515022182, 0.11976762742780017, 0.1189024891300826, 0.11809607991193344, 0.11743662648972696, 0.11676980988579974, 0.11610743589230088, 0.11553628945380674, 0.11518483899852791, 0.11464025134628907, 0.11413710320401252, 0.11377935177207894, 0.11344922133146665, 0.11310331767392098, 0.11272823968221919, 0.11235439899361103, 0.11203342524148355, 0.11179944664540159, 0.11142076259145808, 0.11118218098164205, 0.11099287527859661, 0.11084437315875396, 0.11049735953360421, 0.11038014745006633, 0.10997476941091888, 0.10971899373780571, 0.10978696643555495, 0.10958594573610075, 0.10918513327011234, 0.10898581685812707, 0.10899478298440689, 0.108889123936294, 0.10869089626620339, 0.1085059262755836, 0.10871640545895478, 0.10828193939602945, 0.10814080139626785, 0.10822929959903736, 0.10790811619845686, 0.10790943268039065], 'val_cos': [0.34215779823980641, 0.41656215747898112, 0.48462039217240266, 0.53640767406456413, 0.55662875331619222, 0.56779586578196184, 0.57466147303280968, 0.58555764455338866, 0.59291318652011282, 0.60008826273814853, 0.60495483995384769, 0.609390829612386, 0.61335987783499268, 0.61784949425786206, 0.62015946295759838, 0.62354228058149597, 0.62694502627519277, 0.63015170766964967, 0.63083241763583353, 0.63364174444068888, 0.63652570091506999, 0.63809983345963794, 0.63928280414201755, 0.64091065578556783, 0.64273230404937898, 0.64484002548140906, 0.6462399288448939, 0.64727876348519509, 0.64915946328670016, 0.6502330786635353, 0.65099533108680019, 0.65156911497452397, 0.65329683607711597, 0.65376378637116861, 0.6559282012790516, 0.65708876241664738, 0.65652615297351136, 0.6574723977285909, 0.65949478452692101, 0.66047613851970033, 0.66026002634082093, 0.66071571646169092, 0.66165930678321971, 0.66256386597150518, 0.66157299100001454, 0.66359774141527839, 0.66427443054521118, 0.66386183998746895, 0.66532251486550054, 0.66528852190118593], 'loss': [0.17273225384600022, 0.15287485361099243, 0.14174741033245536, 0.13195149884504431, 0.12524642085327822, 0.12023893237113953, 0.1162493856864817, 0.11338775371803957, 0.11078595287659589, 0.10870536476373673, 0.10681442178347532, 0.10515672038583194, 0.10364828965243171, 0.10234259223236757, 0.10098209104117226, 0.099833652938113498, 0.098644545814570259, 0.097670319956891682, 0.096616954417789683, 0.095687644394005053, 0.094640644420595735, 0.0939228725082734, 0.093010305604513954, 0.092115457443629992, 0.091368833885473358, 0.090618154283832103, 0.08989667680333642, 0.089161997419946334, 0.08845970841015087, 0.087778806686401367, 0.087142801425036262, 0.086540555515710049, 0.08592018954894122, 0.085345568937413838, 0.08472530421088724, 0.084253809381933775, 0.083583626799723684, 0.083107151985168451, 0.082504694374168616, 0.082162274104707375, 0.081573285793556882, 0.081044775002142966, 0.080570087134838098, 0.080156597179525044, 0.079798647165298456, 0.079140670352122369, 0.078805747312657978, 0.078424862903707163, 0.077968476502334363, 0.077511260264060078], 'cos': [0.11161895247066722, 0.39196068146649526, 0.47784117895014144, 0.55991482931024883, 0.60706698866451492, 0.62536560689701759, 0.63606632597306201, 0.64560195151497335, 0.65891613216961131, 0.66803960393456852, 0.67614655340419094, 0.68380664208356068, 0.68954763440524836, 0.69664604747996606, 0.70190112043829522, 0.70676223446341124, 0.71201121302211989, 0.71747049696305221, 0.7209909374573652, 0.72388193901847386, 0.72965890519759236, 0.73416051710353181, 0.73571853791966157, 0.74087887806050923, 0.74417722547755527, 0.74763537378872147, 0.75036860395880312, 0.75317109570783725, 0.75581247666302853, 0.7601890185300042, 0.76183559165281411, 0.7638516186265385, 0.76622923219905181, 0.76819339611951043, 0.77127684551126818, 0.77553254379945646, 0.77694890218622548, 0.77742132747874537, 0.78052372848286344, 0.78455026780857762, 0.78584665242363427, 0.78657182356890509, 0.78920158442328958, 0.79141608574811151, 0.7917214766670676, 0.79456314788145177, 0.79718674673753631, 0.79698844769421751, 0.79919114267124847, 0.8025225758552551]}
last_val_loss=[0.15617567623592443, 0.14860377984323189, 0.14137511675994402, 0.13661818975765699, 0.13341006062343078, 0.1301304269347443, 0.1277897982700946, 0.1260082043088053, 0.12467548847949174, 0.12346172278338775, 0.12231905771517934, 0.12122383473501998, 0.12035610969706206, 0.11952680341843093, 0.11889675210795414, 0.11819918403021935, 0.11765113790104312, 0.11720957310509021, 0.1166371244665057, 0.11610482323454969, 0.11557014902082438, 0.11517581139088277, 0.11472624936317016, 0.1143306920337737, 0.11404040675394481, 0.11380354121740278, 0.11341327109775255, 0.11298123957303069, 0.11268471132597935, 0.11250676924095346, 0.11217321521163888, 0.11175865195785421, 0.111499626574198, 0.11136721911598513, 0.11123150408793457, 0.11089633694223552, 0.1107036978644448, 0.11047184369726205, 0.11033830455778829, 0.11002558537334278, 0.10995714212544919, 0.10962358723284316, 0.10947174244848847, 0.10962358723284316, 0.109624763470411300 , 0.10962560897642023, 0.10962571354512608 , 0.10962680897348068 , 0.109627040016272488 ]
last_val_loss=[0.16027949435134378, 0.15101569380507962, 0.14235669817371993, 0.13658957554951723, 0.1323847797903366, 0.12905983384745548, 0.12679268194536117, 0.12479573981812979, 0.12322121571458557, 0.12184970306058975, 0.12074530515022182, 0.11976762742780017, 0.1189024891300826, 0.11809607991193344, 0.11743662648972696, 0.11676980988579974, 0.11610743589230088, 0.11553628945380674, 0.11518483899852791, 0.11464025134628907, 0.11413710320401252, 0.11377935177207894, 0.11344922133146665, 0.11310331767392098, 0.11272823968221919, 0.11235439899361103, 0.11203342524148355, 0.11179944664540159, 0.11142076259145808, 0.11118218098164205, 0.11099287527859661, 0.11084437315875396, 0.1104973595336042, 0.11038014745006633, 0.10997476941091888, 0.1097189937378057, 0.10978696643555495, 0.10958594573610075, 0.10918513327011234, 0.10898581685812707, 0.10899478298440689, 0.108889123936294, 0.10869089626620339, 0.1087059262755836, 0.10871640545895478, 0.10888193939602945, 0.10888980139626785, 0.1089029959903736, 0.10890311619845686]
print (last_val_loss)
dict_full={'val_loss': [0.14164502235019907, 0.12023828555555904, 0.10118825365515316, 0.092172312035280118, 0.088825892262599043, 0.085307432097547195, 0.083575997545438652, 0.08128108618890538, 0.07984463975710028, 0.079761028026833256, 0.079300368182799397, 0.078464168047203742, 0.077766710519790644, 0.077669986205942496, 0.077629745532484612, 0.077839353855918433, 0.077933202946887298, 0.078047049111478475, 0.078076201781805828, 0.077178218084223135, 0.076700305938720709, 0.076560979029711554, 0.076459721694974336, 0.076397861978586987, 0.07593973717268776, 0.076269391529700331, 0.076460984875174123, 0.075874124204411225, 0.076298387874575227, 0.07598760864313911, 0.075791286808602948, 0.076119945768047786, 0.075763796094585861, 0.076000036562190343, 0.075201973669669214, 0.075566723241525538, 0.075808739486862634, 0.075304168725714965, 0.07528960897642023, 0.076097069154767424, 0.076276347041130066, 0.076436914854189936, 0.076342626178965853, 0.07609198557979921, 0.07532637338427936, 0.075902396002236541, 0.076038930608945732, 0.076119479060173037, 0.076371910006859725, 0.076717613374485683], 'val_cos': [0.45109039965797876, 0.57796738638597378, 0.67184827117358936, 0.70785350659314328, 0.72330253334606398, 0.73015209085801069, 0.73321660406449263, 0.73964423502192778, 0.74265811443328855, 0.74044387901530551, 0.73997639487771427, 0.74118869865641879, 0.74199494754566864, 0.74048283170251283, 0.73904205139945534, 0.73665759002461151, 0.73479424434549667, 0.73499556218876561, 0.73575751991832961, 0.73472046291126925, 0.73590360248790065, 0.7354835987091064, 0.73541253524668071, 0.73470471816904404, 0.73600354334887341, 0.73396533236784089, 0.73257245035732499, 0.73458870649337771, 0.7320654784931856, 0.73307289165609024, 0.73345887450610892, 0.73188324745963607, 0.73264904162463018, 0.73160556344424976, 0.73435735211652864, 0.73274567477843344, 0.73099026750115792, 0.73333136404261867, 0.7328307404237635, 0.72936790760825665, 0.72814960830351882, 0.7275058507919312, 0.72753070382510909, 0.72887507045970246, 0.73135680240743306, 0.72948002534754131, 0.72793450495776013, 0.72589825602138747, 0.72747372038224167, 0.72565203624613139], 'loss': [0.17042510334183189, 0.11859322654850343, 0.083679999761721663, 0.059903433568337383, 0.044227852935300155, 0.033022286677185229, 0.025442246632540928, 0.021267198267228463, 0.018323941506883677, 0.016244593087364645, 0.014844544735901495, 0.013678030012285009, 0.01273356380269808, 0.01195855839725803, 0.011249379835584584, 0.010690635179772097, 0.010364037960329477, 0.010034029591171181, 0.0097140362814945331, 0.0094120031113133704, 0.0091948158107697971, 0.0089428086655543131, 0.0087438032688463441, 0.0085708528866662703, 0.0084402432774796209, 0.0082488148308852132, 0.008174368388512555, 0.0080671719384982302, 0.0079198318807517775, 0.0078012246857671174, 0.0076881539733970865, 0.00762567865278791, 0.0075941182453842723, 0.0074693942223401626, 0.0072959328179850302, 0.0072956428150920309, 0.0073265714680447302, 0.0072268134311718095, 0.0071639508337658997, 0.0070420958430451501, 0.0068922596161856368, 0.0068434963578029593, 0.0068271632580196159, 0.006705900413148543, 0.0067495760124395877, 0.0067408981239970994, 0.0067212727413896254, 0.0067101536756929226, 0.0066430391743779182, 0.0066351683591218558], 'cos': [0.1904598660328809, 0.61462313708137062, 0.77471039856181423, 0.85438700704013604, 0.90350506656310137, 0.93803837018854475, 0.95864908064112941, 0.96952716953614182, 0.97645770100986251, 0.98100400531993193, 0.98344431624693029, 0.98525425265817079, 0.98685252666473389, 0.98761551730773023, 0.98873138638103708, 0.98945180458181048, 0.98938560696209177, 0.9893970307181863, 0.98948826158747949, 0.98973244639003977, 0.98957452353309183, 0.98965189737432147, 0.98981410335091979, 0.98989950348349176, 0.98980496981564692, 0.98958909441443055, 0.98979365825653076, 0.9894760776968563, 0.98972998717251948, 0.98968318841036629, 0.98972794027889477, 0.98968379357281855, 0.98937271062065568, 0.98928726631052355, 0.98987820919822245, 0.98945019595763262, 0.98908333988750685, 0.98940849234076111, 0.98946745255414181, 0.98963319273555983, 0.98984536774018228, 0.98991872002096737, 0.98978724058936629, 0.98988590380724739, 0.98955057228312771, 0.98952860271229459, 0.98947283380171835, 0.98925048253115488, 0.98955147757249717, 0.98920611914466405]}
full_val_loss=dict_full['val_loss'][0:19]

print (len(new_val_loss))
plt.plot()
x1=range(1,15)#15 not in 
x2=range(1,50)
x3=range(1,20)

plt.plot(x1,new_val_loss) 
plt.plot(x2,last_val_loss)
plt.plot(x3,full_val_loss) 
plt.axvline(x=8,color='blue', linestyle='dashed')
plt.axvline(x=43,color='orange', linestyle='dashed')
plt.axvline(x=13,color='green', linestyle='dashed')

plt.title('val_loss vs epoch')  
plt.ylabel('val_loss')  
plt.xlabel('epoch')  
plt.legend(['_New', '_Last','_Full'], loc='upper left')  #,'train_cos','val_cos'
plt.show() 


plt.plot()
new1=[0.0934,0.0870,0.0886,0.0916,0.0896]
last1=[0.1077,0.10957,0.1106,0.1110,0.1113]
full1=[0.0843,0.07906,0.08212,0.0823,0.08256]
x=[0.0,0.2,0.3,0.4,0.5]
plt.plot(x,new1,marker='o',color='blue')
plt.plot(x,last1,marker='o',color='orange')
plt.plot(x,full1,marker='o',color='green')
plt.legend(['_New', '_Last','_Full'], loc='upper left')
plt.show()


plt.plot()
new1=[0.09420,0.0870,0.0912,0.0889,0.0926]
last1=[0.1047,0.10927,0.10946,0.1110,0.1112]
full1=[0.0882,0.07906,0.0837,0.0865,0.0842]
x=[0.0,0.2,0.3,0.4,0.5]
plt.plot(x,new1,marker='o',color='blue')
plt.plot(x,last1,marker='o',color='orange')
plt.plot(x,full1,marker='o',color='green')
plt.legend(['_New', '_Last','_Full'], loc='upper left')
plt.show()



#chain-thaw
dict_last={'val_loss': [0.15685808062553405, 0.14970876223900739, 0.14234700904173009, 0.13657557824078728, 0.1328194590175853, 0.12993097445544075, 0.12853363629649667, 0.12708745160523582, 0.12544722627190982, 0.12436189414823756, 0.12331540505675709, 0.12238512494984795, 0.12137481237159056, 0.12045130615725237, 0.12003824658253613, 0.11957426675978829, 0.1188447093262392, 0.11820403337478638, 0.11775982590282665, 0.11744579050470801, 0.11747857191983391, 0.11689963963101892, 0.11637585732866736, 0.11595694659387364, 0.1156642752535203, 0.11580104599980746, 0.11552810598822201, 0.11538150468293358, 0.11529117217835258, 0.11501418755334966, 0.11486650863114525, 0.11471600330927793, 0.11450092161402983, 0.11425957267775255, 0.11401276991647832, 0.11384151989922804, 0.11368860023863175, 0.11356527235578089, 0.11344838808564579, 0.11343369869624867, 0.11322971354512608, 0.11311075021238888, 0.11288618340211756, 0.11309038076330634, 0.11281386456068825, 0.11277622825959149, 0.1126591418595875, 0.11302309904028388, 0.11297560939017465, 0.11257589985342586], 'val_cos': [0.33348959544125722, 0.3968260207596947, 0.45458670013091146, 0.50042275330599617, 0.52663347300361185, 0.53884206379161159, 0.54262719504973467, 0.55083327854380892, 0.56045019696740539, 0.56664238607182227, 0.57245580729316259, 0.57764945380827959, 0.58329714817159317, 0.58842030553256763, 0.59077018148758831, 0.59330417408662683, 0.59733305818894333, 0.60085271106046789, 0.60323128489887012, 0.60489729222129374, 0.60512044640148388, 0.60797995399026306, 0.61074368673212387, 0.61302821636199956, 0.61464216358521406, 0.61438746662700883, 0.61579714522642248, 0.61642962343552532, 0.61708613984725058, 0.61843291871687944, 0.61919674803228941, 0.62038414548425114, 0.62178953815908988, 0.62285308487275071, 0.62397266626358028, 0.62502795527963073, 0.62567885342766261, 0.62634472706738642, 0.62736169730915747, 0.62780062661451452, 0.62850076310774861, 0.62906925467883834, 0.63039672585094675, 0.6302225968416999, 0.63079887067570406, 0.6307083634769215, 0.63165653873892391, 0.63123387869666603, 0.63116288746104521, 0.63211129412931555], 'loss': [0.16637768079252804, 0.1504102233578177, 0.14078164626570308, 0.13217026100439183, 0.12636995666167317, 0.1217262096264783, 0.11769912961651297, 0.1150576832539895, 0.11246812948409249, 0.11021017318262774, 0.10847966820001602, 0.10668706648490008, 0.1051640138906591, 0.10378327264505274, 0.10252479227150188, 0.10126732745591333, 0.10004279043744592, 0.099011433913427246, 0.097920737897648533, 0.097037813768667339, 0.096036022024996143, 0.095044379900483519, 0.094106193938676044, 0.09331263514126048, 0.092565904207089364, 0.09162895460339153, 0.090915704562383542, 0.09019921211635365, 0.089418779488872085, 0.088729587723227102, 0.088122585766455708, 0.087350759962025806, 0.086755554816302136, 0.086236053968177129, 0.085570605011547313, 0.084992376583464008, 0.084398266848395853, 0.083871650169877451, 0.083318821296972392, 0.082773241137757025, 0.082224165253779471, 0.08169846175348057, 0.081216803894323467, 0.080786504114375393, 0.080222703078213858, 0.079760358000502865, 0.079348013330908379, 0.078873778616680823, 0.078664050382726336, 0.07792072085773244], 'cos': [0.27349518221967362, 0.41942488410893608, 0.48881125450134277, 0.55469026705797986, 0.60058317324694466, 0.62263693108278162, 0.63076661544687607, 0.63499465409447164, 0.64940644923378443, 0.66281722924288577, 0.67127186971552233, 0.6782187419779161, 0.68413175414590277, 0.69106972708421599, 0.69593467502033013, 0.70133728069417622, 0.70647069917005656, 0.71112128776662487, 0.71839954853057864, 0.72297008668675145, 0.7239687660161187, 0.72957949988982251, 0.73423964626648852, 0.73774539723115806, 0.74177014406989605, 0.74448144926744353, 0.74629741486381085, 0.75015366357915547, 0.75380427066017597, 0.75663099990171545, 0.75988048595540669, 0.76171390519422644, 0.76454414830488315, 0.76587631912792431, 0.76955902295954082, 0.77255919891245228, 0.77436039658153755, 0.77778049567166496, 0.77878150168587179, 0.78042449600556318, 0.78254107867970191, 0.78557751599480119, 0.78748384784249703, 0.78835263112012077, 0.79091307415681722, 0.7943894309156081, 0.79690310043447155, 0.7954342940274407, 0.7962247813449187, 0.80024465462740735]}

dict_embed={'val_loss': [0.10143698160759448, 0.096227013306593709, 0.092192438015859732, 0.089899727882305977, 0.088192411705438678, 0.087044715993950889], 'val_cos': [0.69037666894326577, 0.70840959269694181, 0.72034618521217131, 0.72484307880665855, 0.72764221712083599, 0.72843980819212095], 'loss': [0.077185557309318989, 0.05814961712150013, 0.046491996838765988, 0.038157784570665917, 0.032504147580441303, 0.028000989613287588], 'cos': [0.79859472386977248, 0.86601438620511229, 0.9013720318850349, 0.92629736367393944, 0.94102156442754414, 0.95186030247632192]}

dict_lstm_0={}
dict_lstm_1={}
dict_att={'val_loss': [0.086900102044983538, 0.086700839832687865, 0.086575842455442364, 0.086539380177292471, 0.086580893067028417], 'val_cos': [0.72925861656515667, 0.73026836203688039, 0.73097480544515459, 0.73127937707252411, 0.73122771515954355], 'loss': [0.025603097856921306, 0.025372794252984665, 0.025236996188759804, 0.025126918282578972, 0.025017958730459214], 'cos': [0.95744008036220773, 0.95788610907161942, 0.95840470959158508, 0.95865216535680431, 0.95907240559073059]}

dict_all={}


train_loss=dict_last['loss'][0:43]+dict_embed['loss']+dict_att['loss']
val_loss=dict_last['val_loss'][0:43]+dict_embed['val_loss']+dict_att['val_loss']
train_cos=dict_last['cos'][0:43]+dict_embed['cos']+dict_att['cos']
val_cos=dict_last['val_cos'][0:43]+dict_embed['val_cos']+dict_att['val_cos']
epochs=[43,6,1,2,3]
print (len(dict_last['loss']))

print (len(train_loss))
plt.plot()



x=range(1,55)

plt.plot(x,train_loss) 
plt.plot(x,val_loss)
plt.plot(x,train_cos) 
plt.plot(x,val_cos) 
plt.axvline(x=43,color='black', linestyle='dashed')
plt.axvline(x=48,color='black', linestyle='dashed')
plt.axvline(x=50,color='black', linestyle='dashed')

plt.axvline(x=52,color='black', linestyle='dashed')
plt.axvline(x=53,color='black', linestyle='dashed')


plt.title('loss(WCS) vs epoch (Financial Microblogs)')  
plt.ylabel('loss(WCS)')  
plt.xlabel('epoch')  
plt.legend(['train_loss', 'test_loss','train_WCS','test_WCS'], loc='upper left')  #,'train_cos','val_cos'
plt.show() 



'''
##############headlines

#New validation
dict_new={'val_loss': [0.13593576410237482, 0.1114623082034728, 0.10324581142734079, 0.096633983710232907, 0.095409949123859403, 0.096563492715358731, 0.093345738509122061, 0.093543811493060167, 0.088636109758825868, 0.094721319657914776, 0.093507649968652171, 0.091042062201920682, 0.094341443391407237, 0.092802222336039825, 0.094753073418841649, 0.096597828409251046, 0.09411576320143307, 0.097207035474917464, 0.098357212105218098, 0.096714585931862107, 0.09578231608166414, 0.098910736336427579, 0.098158552541452296, 0.099191260337829587, 0.1006702366120675, 0.10145835464491564, 0.098114814214846663, 0.098522480270441845, 0.10136223540586584, 0.099133772183867055, 0.099387955928550042, 0.10006762497565326, 0.10093137542991078, 0.10102166770135655, 0.10048864948398926, 0.099797668790116034, 0.10479633518878151, 0.099030587690718028, 0.10207216231261983, 0.098755644174183116, 0.10083118335289114, 0.10023230901535819, 0.10195320029469097, 0.099622553849921511, 0.098237086569561677, 0.099456153810024261, 0.10376673998201595, 0.10155707746744155, 0.099809920963119053, 0.10168184497777154], 'val_cos': [0.42878434622988981, 0.59433190121370205, 0.6367513923084035, 0.65213729002896481, 0.64882023895488061, 0.65640224779353418, 0.66404191816554348, 0.65964373069650983, 0.67399620238472435, 0.6585961215636309, 0.66010482591741226, 0.65905221630545219, 0.65157692502526676, 0.65558785270242126, 0.65522432537639841, 0.64455320554621076, 0.65590094047434189, 0.64488155070473163, 0.6415409515885746, 0.64085416092592129, 0.64585122781641346, 0.63688524260240442, 0.64056311986025638, 0.63646606417263252, 0.63389414759243234, 0.63516604549744549, 0.63781608413247504, 0.63683490542804488, 0.63132271205677704, 0.63439167878207037, 0.63180405041750742, 0.63049113469965312, 0.6289898311390596, 0.62848392865237068, 0.63139159679412837, 0.63277418964049392, 0.62059752660639145, 0.63077982173246494, 0.62639424660626575, 0.63722021719988653, 0.63018497088376213, 0.63093739818124206, 0.62586500714806947, 0.63432785553090709, 0.63162292873158177, 0.63618016803965849, 0.62939804722281067, 0.63108214420430797, 0.63612844383015354, 0.63249383884317734], 'loss': [0.15282268804662369, 0.098698724017423745, 0.057927210585159414, 0.042083621594835731, 0.03299643577021711, 0.02708522800137015, 0.022313195992918575, 0.019633072264054242, 0.016533316474627045, 0.014429582984131925, 0.012954744137823581, 0.01210201098857557, 0.010947919790359105, 0.010331945187028716, 0.0098056813482852549, 0.0092023484518422797, 0.0089171185706029919, 0.0088527253500240693, 0.0084048139917499883, 0.0082756997086107734, 0.0078295975594836129, 0.0077688651378540431, 0.0077084681676591145, 0.0074580446104792987, 0.0071344052386634492, 0.0071179445449481996, 0.0068403284120209075, 0.0065431284334729698, 0.0067526244174908193, 0.0065305233166060026, 0.0065057300633805642, 0.0061708407147842296, 0.0059658447170958797, 0.0061346427318366131, 0.0060252847204751827, 0.0062274218591697079, 0.006354171328027459, 0.0067684318158118166, 0.0065970874994116671, 0.0060866590698852256, 0.0062817223972695714, 0.0060248997500714132, 0.0058509959236663928, 0.0057026107439442589, 0.0057977822773596817, 0.0055783751146758305, 0.005856476641972275, 0.0055722089566509515, 0.0054486866396687489, 0.0052443009801208971], 'cos': [0.29407859532272113, 0.6626572728157043, 0.82828818980385277, 0.8816662914612714, 0.91135352359098543, 0.92802368542727298, 0.93983459683025583, 0.94594475872376382, 0.95398543792612411, 0.95991726622861973, 0.96316596970838664, 0.96503182719735536, 0.967911934151369, 0.96917275400722724, 0.9706325418808881, 0.97247081784641043, 0.97319765862296614, 0.97318432611577654, 0.9744189206291648, 0.97470144664540015, 0.97601513582117416, 0.97681974943946392, 0.97651214108747597, 0.97747654423994179, 0.97838278518003574, 0.97843070170458624, 0.9796307122006136, 0.98049161083558023, 0.9798262981807484, 0.98047354501836437, 0.98049417874392342, 0.98137971092672904, 0.9821776074521682, 0.98153907551484953, 0.98201057139564962, 0.98136485183940214, 0.98111187850727755, 0.97999029089422784, 0.9802661460988662, 0.98179347444983089, 0.9810015874750474, 0.98208343000972975, 0.98226803751552805, 0.98289149508756746, 0.98292112210217641, 0.98416383546941422, 0.98292693811304432, 0.98396687577752506, 0.98385706368614645, 0.9845767708385692]}
dict_last={'val_loss': [0.15685808062553405, 0.14970876223900739, 0.14234700904173009, 0.13657557824078728, 0.1328194590175853, 0.12993097445544075, 0.12853363629649667, 0.12708745160523582, 0.12544722627190982, 0.12436189414823756, 0.12331540505675709, 0.12238512494984795, 0.12137481237159056, 0.12045130615725237, 0.12003824658253613, 0.11957426675978829, 0.1188447093262392, 0.11820403337478638, 0.11775982590282665, 0.11744579050470801, 0.11747857191983391, 0.11689963963101892, 0.11637585732866736, 0.11595694659387364, 0.1156642752535203, 0.11580104599980746, 0.11552810598822201, 0.11538150468293358, 0.11529117217835258, 0.11501418755334966, 0.11486650863114525, 0.11471600330927793, 0.11450092161402983, 0.11425957267775255, 0.11401276991647832, 0.11384151989922804, 0.11368860023863175, 0.11356527235578089, 0.11344838808564579, 0.11343369869624867, 0.11322971354512608, 0.11311075021238888, 0.11288618340211756, 0.11309038076330634, 0.11281386456068825, 0.11277622825959149, 0.1126591418595875, 0.11302309904028388, 0.11297560939017465, 0.11257589985342586], 'val_cos': [0.33348959544125722, 0.3968260207596947, 0.45458670013091146, 0.50042275330599617, 0.52663347300361185, 0.53884206379161159, 0.54262719504973467, 0.55083327854380892, 0.56045019696740539, 0.56664238607182227, 0.57245580729316259, 0.57764945380827959, 0.58329714817159317, 0.58842030553256763, 0.59077018148758831, 0.59330417408662683, 0.59733305818894333, 0.60085271106046789, 0.60323128489887012, 0.60489729222129374, 0.60512044640148388, 0.60797995399026306, 0.61074368673212387, 0.61302821636199956, 0.61464216358521406, 0.61438746662700883, 0.61579714522642248, 0.61642962343552532, 0.61708613984725058, 0.61843291871687944, 0.61919674803228941, 0.62038414548425114, 0.62178953815908988, 0.62285308487275071, 0.62397266626358028, 0.62502795527963073, 0.62567885342766261, 0.62634472706738642, 0.62736169730915747, 0.62780062661451452, 0.62850076310774861, 0.62906925467883834, 0.63039672585094675, 0.6302225968416999, 0.63079887067570406, 0.6307083634769215, 0.63165653873892391, 0.63123387869666603, 0.63116288746104521, 0.63211129412931555], 'loss': [0.16637768079252804, 0.1504102233578177, 0.14078164626570308, 0.13217026100439183, 0.12636995666167317, 0.1217262096264783, 0.11769912961651297, 0.1150576832539895, 0.11246812948409249, 0.11021017318262774, 0.10847966820001602, 0.10668706648490008, 0.1051640138906591, 0.10378327264505274, 0.10252479227150188, 0.10126732745591333, 0.10004279043744592, 0.099011433913427246, 0.097920737897648533, 0.097037813768667339, 0.096036022024996143, 0.095044379900483519, 0.094106193938676044, 0.09331263514126048, 0.092565904207089364, 0.09162895460339153, 0.090915704562383542, 0.09019921211635365, 0.089418779488872085, 0.088729587723227102, 0.088122585766455708, 0.087350759962025806, 0.086755554816302136, 0.086236053968177129, 0.085570605011547313, 0.084992376583464008, 0.084398266848395853, 0.083871650169877451, 0.083318821296972392, 0.082773241137757025, 0.082224165253779471, 0.08169846175348057, 0.081216803894323467, 0.080786504114375393, 0.080222703078213858, 0.079760358000502865, 0.079348013330908379, 0.078873778616680823, 0.078664050382726336, 0.07792072085773244], 'cos': [0.27349518221967362, 0.41942488410893608, 0.48881125450134277, 0.55469026705797986, 0.60058317324694466, 0.62263693108278162, 0.63076661544687607, 0.63499465409447164, 0.64940644923378443, 0.66281722924288577, 0.67127186971552233, 0.6782187419779161, 0.68413175414590277, 0.69106972708421599, 0.69593467502033013, 0.70133728069417622, 0.70647069917005656, 0.71112128776662487, 0.71839954853057864, 0.72297008668675145, 0.7239687660161187, 0.72957949988982251, 0.73423964626648852, 0.73774539723115806, 0.74177014406989605, 0.74448144926744353, 0.74629741486381085, 0.75015366357915547, 0.75380427066017597, 0.75663099990171545, 0.75988048595540669, 0.76171390519422644, 0.76454414830488315, 0.76587631912792431, 0.76955902295954082, 0.77255919891245228, 0.77436039658153755, 0.77778049567166496, 0.77878150168587179, 0.78042449600556318, 0.78254107867970191, 0.78557751599480119, 0.78748384784249703, 0.78835263112012077, 0.79091307415681722, 0.7943894309156081, 0.79690310043447155, 0.7954342940274407, 0.7962247813449187, 0.80024465462740735]}
dict_full={'val_loss': [0.14164502235019907, 0.12023828555555904, 0.10118825365515316, 0.092172312035280118, 0.088825892262599043, 0.085307432097547195, 0.083575997545438652, 0.08128108618890538, 0.07984463975710028, 0.079761028026833256, 0.079300368182799397, 0.078464168047203742, 0.077766710519790644, 0.077669986205942496, 0.077629745532484612, 0.077839353855918433, 0.077933202946887298, 0.077647049111478475, 0.077176201781805828, 0.077178218084223135, 0.076700305938720709, 0.076560979029711554, 0.076459721694974336, 0.076397861978586987, 0.07593973717268776, 0.076269391529700331, 0.076460984875174123, 0.075874124204411225, 0.076298387874575227, 0.07598760864313911, 0.075791286808602948, 0.076119945768047786, 0.075763796094585861, 0.076000036562190343, 0.075201973669669214, 0.075566723241525538, 0.075808739486862634, 0.075304168725714965, 0.07528960897642023, 0.076097069154767424, 0.076276347041130066, 0.076436914854189936, 0.076342626178965853, 0.07609198557979921, 0.07532637338427936, 0.075902396002236541, 0.076038930608945732, 0.076619479060173037, 0.075971910006859725, 0.076717613374485683], 'val_cos': [0.45109039965797876, 0.57796738638597378, 0.67184827117358936, 0.70785350659314328, 0.72330253334606398, 0.73015209085801069, 0.73321660406449263, 0.73964423502192778, 0.74265811443328855, 0.74044387901530551, 0.73997639487771427, 0.74118869865641879, 0.74199494754566864, 0.74048283170251283, 0.73904205139945534, 0.73665759002461151, 0.73479424434549667, 0.73499556218876561, 0.73575751991832961, 0.73472046291126925, 0.73590360248790065, 0.7354835987091064, 0.73541253524668071, 0.73470471816904404, 0.73600354334887341, 0.73396533236784089, 0.73257245035732499, 0.73458870649337771, 0.7320654784931856, 0.73307289165609024, 0.73345887450610892, 0.73188324745963607, 0.73264904162463018, 0.73160556344424976, 0.73435735211652864, 0.73274567477843344, 0.73099026750115792, 0.73333136404261867, 0.7328307404237635, 0.72936790760825665, 0.72814960830351882, 0.7275058507919312, 0.72753070382510909, 0.72887507045970246, 0.73135680240743306, 0.72948002534754131, 0.72793450495776013, 0.72589825602138747, 0.72747372038224167, 0.72565203624613139], 'loss': [0.17042510334183189, 0.11859322654850343, 0.083679999761721663, 0.059903433568337383, 0.044227852935300155, 0.033022286677185229, 0.025442246632540928, 0.021267198267228463, 0.018323941506883677, 0.016244593087364645, 0.014844544735901495, 0.013678030012285009, 0.01273356380269808, 0.01195855839725803, 0.011249379835584584, 0.010690635179772097, 0.010364037960329477, 0.010034029591171181, 0.0097140362814945331, 0.0094120031113133704, 0.0091948158107697971, 0.0089428086655543131, 0.0087438032688463441, 0.0085708528866662703, 0.0084402432774796209, 0.0082488148308852132, 0.008174368388512555, 0.0080671719384982302, 0.0079198318807517775, 0.0078012246857671174, 0.0076881539733970865, 0.00762567865278791, 0.0075941182453842723, 0.0074693942223401626, 0.0072959328179850302, 0.0072956428150920309, 0.0073265714680447302, 0.0072268134311718095, 0.0071639508337658997, 0.0070420958430451501, 0.0068922596161856368, 0.0068434963578029593, 0.0068271632580196159, 0.006705900413148543, 0.0067495760124395877, 0.0067408981239970994, 0.0067212727413896254, 0.0067101536756929226, 0.0066430391743779182, 0.0066351683591218558], 'cos': [0.1904598660328809, 0.61462313708137062, 0.77471039856181423, 0.85438700704013604, 0.90350506656310137, 0.93803837018854475, 0.95864908064112941, 0.96952716953614182, 0.97645770100986251, 0.98100400531993193, 0.98344431624693029, 0.98525425265817079, 0.98685252666473389, 0.98761551730773023, 0.98873138638103708, 0.98945180458181048, 0.98938560696209177, 0.9893970307181863, 0.98948826158747949, 0.98973244639003977, 0.98957452353309183, 0.98965189737432147, 0.98981410335091979, 0.98989950348349176, 0.98980496981564692, 0.98958909441443055, 0.98979365825653076, 0.9894760776968563, 0.98972998717251948, 0.98968318841036629, 0.98972794027889477, 0.98968379357281855, 0.98937271062065568, 0.98928726631052355, 0.98987820919822245, 0.98945019595763262, 0.98908333988750685, 0.98940849234076111, 0.98946745255414181, 0.98963319273555983, 0.98984536774018228, 0.98991872002096737, 0.98978724058936629, 0.98988590380724739, 0.98955057228312771, 0.98952860271229459, 0.98947283380171835, 0.98925048253115488, 0.98955147757249717, 0.98920611914466405]}


train_loss=dict_full['loss']
val_loss=dict_full['val_loss']
train_cos=dict_full['cos']
val_cos=dict_full['val_cos']

plt.plot()
x=range(1,51)
plt.plot(x,train_loss) 
plt.plot(x,val_loss)
plt.plot(x,train_cos) 
plt.plot(x,val_cos) 
plt.axvline(x=9,color='black', linestyle='dashed')
plt.title('loss(cos) vs epoch (Emoji_)')  
plt.ylabel('loss(cos)')  
plt.xlabel('epoch')  
plt.legend(['train_loss', 'val_loss','train_cos','val_cos'], loc='upper left')  #,'train_cos','val_cos'
plt.show() 

'''


'''
#chain-thaw
dict_last={'val_loss': [0.15685808062553405, 0.14970876223900739, 0.14234700904173009, 0.13657557824078728, 0.1328194590175853, 0.12993097445544075, 0.12853363629649667, 0.12708745160523582, 0.12544722627190982, 0.12436189414823756, 0.12331540505675709, 0.12238512494984795, 0.12137481237159056, 0.12045130615725237, 0.12003824658253613, 0.11957426675978829, 0.1188447093262392, 0.11820403337478638, 0.11775982590282665, 0.11744579050470801, 0.11747857191983391, 0.11689963963101892, 0.11637585732866736, 0.11595694659387364, 0.1156642752535203, 0.11580104599980746, 0.11552810598822201, 0.11538150468293358, 0.11529117217835258, 0.11501418755334966, 0.11486650863114525, 0.11471600330927793, 0.11450092161402983, 0.11425957267775255, 0.11401276991647832, 0.11384151989922804, 0.11368860023863175, 0.11356527235578089, 0.11344838808564579, 0.11343369869624867, 0.11322971354512608, 0.11311075021238888, 0.11288618340211756, 0.11309038076330634, 0.11281386456068825, 0.11277622825959149, 0.1126591418595875, 0.11302309904028388, 0.11297560939017465, 0.11257589985342586], 'val_cos': [0.33348959544125722, 0.3968260207596947, 0.45458670013091146, 0.50042275330599617, 0.52663347300361185, 0.53884206379161159, 0.54262719504973467, 0.55083327854380892, 0.56045019696740539, 0.56664238607182227, 0.57245580729316259, 0.57764945380827959, 0.58329714817159317, 0.58842030553256763, 0.59077018148758831, 0.59330417408662683, 0.59733305818894333, 0.60085271106046789, 0.60323128489887012, 0.60489729222129374, 0.60512044640148388, 0.60797995399026306, 0.61074368673212387, 0.61302821636199956, 0.61464216358521406, 0.61438746662700883, 0.61579714522642248, 0.61642962343552532, 0.61708613984725058, 0.61843291871687944, 0.61919674803228941, 0.62038414548425114, 0.62178953815908988, 0.62285308487275071, 0.62397266626358028, 0.62502795527963073, 0.62567885342766261, 0.62634472706738642, 0.62736169730915747, 0.62780062661451452, 0.62850076310774861, 0.62906925467883834, 0.63039672585094675, 0.6302225968416999, 0.63079887067570406, 0.6307083634769215, 0.63165653873892391, 0.63123387869666603, 0.63116288746104521, 0.63211129412931555], 'loss': [0.16637768079252804, 0.1504102233578177, 0.14078164626570308, 0.13217026100439183, 0.12636995666167317, 0.1217262096264783, 0.11769912961651297, 0.1150576832539895, 0.11246812948409249, 0.11021017318262774, 0.10847966820001602, 0.10668706648490008, 0.1051640138906591, 0.10378327264505274, 0.10252479227150188, 0.10126732745591333, 0.10004279043744592, 0.099011433913427246, 0.097920737897648533, 0.097037813768667339, 0.096036022024996143, 0.095044379900483519, 0.094106193938676044, 0.09331263514126048, 0.092565904207089364, 0.09162895460339153, 0.090915704562383542, 0.09019921211635365, 0.089418779488872085, 0.088729587723227102, 0.088122585766455708, 0.087350759962025806, 0.086755554816302136, 0.086236053968177129, 0.085570605011547313, 0.084992376583464008, 0.084398266848395853, 0.083871650169877451, 0.083318821296972392, 0.082773241137757025, 0.082224165253779471, 0.08169846175348057, 0.081216803894323467, 0.080786504114375393, 0.080222703078213858, 0.079760358000502865, 0.079348013330908379, 0.078873778616680823, 0.078664050382726336, 0.07792072085773244], 'cos': [0.27349518221967362, 0.41942488410893608, 0.48881125450134277, 0.55469026705797986, 0.60058317324694466, 0.62263693108278162, 0.63076661544687607, 0.63499465409447164, 0.64940644923378443, 0.66281722924288577, 0.67127186971552233, 0.6782187419779161, 0.68413175414590277, 0.69106972708421599, 0.69593467502033013, 0.70133728069417622, 0.70647069917005656, 0.71112128776662487, 0.71839954853057864, 0.72297008668675145, 0.7239687660161187, 0.72957949988982251, 0.73423964626648852, 0.73774539723115806, 0.74177014406989605, 0.74448144926744353, 0.74629741486381085, 0.75015366357915547, 0.75380427066017597, 0.75663099990171545, 0.75988048595540669, 0.76171390519422644, 0.76454414830488315, 0.76587631912792431, 0.76955902295954082, 0.77255919891245228, 0.77436039658153755, 0.77778049567166496, 0.77878150168587179, 0.78042449600556318, 0.78254107867970191, 0.78557751599480119, 0.78748384784249703, 0.78835263112012077, 0.79091307415681722, 0.7943894309156081, 0.79690310043447155, 0.7954342940274407, 0.7962247813449187, 0.80024465462740735]}

dict_embed={'val_loss': [0.10143698160759448, 0.096227013306593709, 0.092192438015859732, 0.089899727882305977, 0.088192411705438678, 0.087044715993950889], 'val_cos': [0.69037666894326577, 0.70840959269694181, 0.72034618521217131, 0.72484307880665855, 0.72764221712083599, 0.72843980819212095], 'loss': [0.077185557309318989, 0.05814961712150013, 0.046491996838765988, 0.038157784570665917, 0.032504147580441303, 0.028000989613287588], 'cos': [0.79859472386977248, 0.86601438620511229, 0.9013720318850349, 0.92629736367393944, 0.94102156442754414, 0.95186030247632192]}

dict_lstm_0={}
dict_lstm_1={}
dict_att={'val_loss': [0.086900102044983538, 0.086700839832687865, 0.086575842455442364, 0.086539380177292471, 0.086580893067028417], 'val_cos': [0.72925861656515667, 0.73026836203688039, 0.73097480544515459, 0.73127937707252411, 0.73122771515954355], 'loss': [0.025603097856921306, 0.025372794252984665, 0.025236996188759804, 0.025126918282578972, 0.025017958730459214], 'cos': [0.95744008036220773, 0.95788610907161942, 0.95840470959158508, 0.95865216535680431, 0.95907240559073059]}

dict_all={}


train_loss=dict_last['loss'][0:43]+dict_embed['loss']+dict_att['loss']
val_loss=dict_last['val_loss'][0:43]+dict_embed['val_loss']+dict_att['val_loss']
train_cos=dict_last['cos'][0:43]+dict_embed['cos']+dict_att['cos']
val_cos=dict_last['val_cos'][0:43]+dict_embed['val_cos']+dict_att['val_cos']
epochs=[43,6,0,0,5,0]
print (len(dict_last['loss']))

print (len(train_loss))
plt.plot()

x=range(1,55)

plt.plot(x,train_loss) 
plt.plot(x,val_loss)
plt.plot(x,train_cos) 
plt.plot(x,val_cos) 
plt.axvline(x=43,color='black', linestyle='dashed')
plt.axvline(x=49,color='black', linestyle='dashed')

plt.title('loss(cos) vs epoch (Emoji_)')  
plt.ylabel('loss(cos)')  
plt.xlabel('epoch')  
plt.legend(['train_loss', 'test_loss','train_cos','test_cos'], loc='upper left')  #,'train_cos','val_cos'
plt.show() 

'''
