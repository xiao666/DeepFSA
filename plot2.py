import numpy as np
import matplotlib.pyplot as plt


##############microblogs

#New validation
dict_new={'val_loss': [0.15055903792381287, 0.13036978244781494, 0.11930812895298004, 0.1201191246509552, 0.12114200741052628, 0.1150096133351326, 0.11823131144046783, 0.10885290801525116, 0.11373420804738998, 0.10748866200447083, 0.10949398577213287, 0.10782948881387711, 0.11382001638412476, 0.10186102986335754, 0.1067134365439415, 0.10203797370195389, 0.10725442320108414, 0.1025325283408165, 0.10681898146867752, 0.10300256311893463], 'val_cos': [0.38244113326072693, 0.4534822404384613, 0.50596100091934204, 0.51061868667602539, 0.52565681934356689, 0.54341167211532593, 0.56047701835632324, 0.56667244434356689, 0.57086735963821411, 0.58165645599365234, 0.58697575330734253, 0.57489520311355591, 0.57609474658966064, 0.5944364070892334, 0.59860795736312866, 0.59381777048110962, 0.59596747159957886, 0.59341400861740112, 0.59164869785308838, 0.59088456630706787], 'loss': [0.17003501142168098, 0.15240221734180115, 0.10582269569053054, 0.065703619957002857, 0.04835130750055773, 0.036305989409100188, 0.028648247356809112, 0.02332212092091716, 0.020586190704431746, 0.017574172887261569, 0.015780835464466181, 0.013745748953075686, 0.013270142139318151, 0.012372648531136482, 0.011099059304053133, 0.010345259138667571, 0.0099751546526040073, 0.0096745844899808336, 0.0094968876628019529, 0.0092509958305501214], 'cos': [0.06116160339097465, 0.50587007253219629, 0.67775525124937397, 0.81016603487605987, 0.86554284333399323, 0.90088247469456018, 0.92546248135665943, 0.94193845184321989, 0.94795183590965226, 0.95610434841874659, 0.96148688358388357, 0.9656544233726384, 0.96586477534533333, 0.96762768384008002, 0.97098908118846516, 0.9715599031202895, 0.97292442402729984, 0.97291862912402616, 0.97245779166738666, 0.97349951725538819]}
new_val_loss=dict_new['val_loss']#14+6

dict_full={'val_loss': [0.15716108679771423, 0.14718838036060333, 0.13592500984668732, 0.12436920404434204, 0.11654806137084961, 0.11743208020925522, 0.11886498332023621, 0.11284345388412476, 0.10852498561143875, 0.10702689737081528, 0.10629517585039139, 0.1061750203371048, 0.10633368790149689, 0.106061190366745, 0.10474966466426849, 0.1033233255147934, 0.10199961066246033, 0.10137302428483963, 0.10164283215999603, 0.10144712030887604, 0.10139566659927368, 0.10103785246610641, 0.10066033899784088, 0.099674805998802185, 0.098718933761119843, 0.097002319991588593, 0.096611760556697845, 0.096297644078731537, 0.095900632441043854, 0.096070915460586548, 0.09614553302526474, 0.096360944211483002, 0.096824735403060913, 0.097251437604427338, 0.097479000687599182], 'val_cos': [0.28507384657859802, 0.42758604884147644, 0.4794592559337616, 0.52576541900634766, 0.55886673927307129, 0.58159732818603516, 0.60152870416641235, 0.61932432651519775, 0.62519192695617676, 0.6236579418182373, 0.62272900342941284, 0.62380862236022949, 0.62605297565460205, 0.62849140167236328, 0.62840157747268677, 0.62982839345932007, 0.63208580017089844, 0.63179224729537964, 0.63290607929229736, 0.63208216428756714, 0.63199710845947266, 0.63163203001022339, 0.63381677865982056, 0.63699477910995483, 0.64155822992324829, 0.64268004894256592, 0.64547401666641235, 0.64723324775695801, 0.64725953340530396, 0.64711052179336548, 0.64481264352798462, 0.64148294925689697, 0.63746190071105957, 0.63655120134353638, 0.63554847240447998], 'loss': [0.17793574326988901, 0.16142455884229967, 0.14147126712190622, 0.12014808526990969, 0.093806351670691374, 0.07349607503492496, 0.060194464194356805, 0.051390627845876974, 0.043143156511955952, 0.036956222464717102, 0.030957588719903836, 0.029497337128726309, 0.026351428536651299, 0.02544072930581729, 0.023386898920805012, 0.022616152679149841, 0.021331043214193442, 0.019962874244233472, 0.019236667679473841, 0.018416926472856861, 0.018406764872429274, 0.017257561509345473, 0.016078467944969484, 0.015373046702714504, 0.015356481462912909, 0.015314698835420713, 0.015110442678057482, 0.014203033270263333, 0.014404368973444222, 0.013873877165979846, 0.014006752095431056, 0.012913773555475872, 0.01241698216234802, 0.012829962711850627, 0.012202262062363139], 'cos': [0.0584498476420671, 0.39250582897258351, 0.58481129817868638, 0.67924487656074184, 0.75421070686958702, 0.8036055756816467, 0.84478673870957821, 0.87630659426681834, 0.90125772562632822, 0.91984199655016829, 0.93865719493090916, 0.94122006917966028, 0.95008286269053177, 0.95106651468318759, 0.95707067191143813, 0.95769492036541604, 0.96051118930093826, 0.964189357198734, 0.96506590878454257, 0.96646861661825356, 0.96505280098544288, 0.96844275117834455, 0.97128668195707779, 0.9731749704868613, 0.97253462930106904, 0.97146779422822682, 0.97198810752354736, 0.97413085676884725, 0.97278069927554012, 0.97391097804149951, 0.97338401363817784, 0.97610959851337031, 0.97740430175148252, 0.9750299370171337, 0.97723936447047455]}
full_val_loss=dict_full['val_loss']#29+6


dict_last={'val_loss': [0.16324329376220703, 0.15982106328010559, 0.15671387314796448, 0.15417256951332092, 0.1521821916103363, 0.15003353357315063, 0.14816075563430786, 0.14650553464889526, 0.14486855268478394, 0.14373058080673218, 0.14287739992141724, 0.1418018639087677, 0.14090242981910706, 0.14033590257167816, 0.13996943831443787, 0.13934266567230225, 0.13935434818267822, 0.13885295391082764, 0.13804823160171509, 0.13774630427360535, 0.13745883107185364, 0.13709244132041931, 0.13703817129135132, 0.13701394200325012, 0.13669863343238831, 0.13614794611930847, 0.13575541973114014, 0.13561111688613892, 0.13536269962787628, 0.13506877422332764, 0.13502290844917297, 0.13502234220504761, 0.1348145604133606, 0.13460326194763184, 0.13430781662464142, 0.13442340493202209, 0.13445356488227844, 0.13401034474372864, 0.13376322388648987, 0.13371428847312927, 0.13359495997428894, 0.13343089818954468, 0.13332344591617584, 0.13335725665092468, 0.13337299227714539, 0.13328006863594055, 0.13314232230186462, 0.13293233513832092, 0.13259699940681458, 0.13244834542274475, 0.13261595368385315, 0.13292872905731201, 0.13246172666549683, 0.13222891092300415, 0.13212962448596954, 0.13218861818313599, 0.13221156597137451, 0.13156884942054749, 0.13216853141784668, 0.13189783692359924, 0.13168260455131531, 0.1316428929567337, 0.1316554993391037, 0.13209354877471924], 'val_cos': [0.13897955417633057, 0.20736600458621979, 0.26982316374778748, 0.34485876560211182, 0.38323831558227539, 0.39804509282112122, 0.40819406509399414, 0.41627517342567444, 0.42068251967430115, 0.42503619194030762, 0.42734527587890625, 0.43026682734489441, 0.43213355541229248, 0.43393838405609131, 0.43461695313453674, 0.43692401051521301, 0.43504926562309265, 0.43737080693244934, 0.44183656573295593, 0.44321316480636597, 0.44461977481842041, 0.44641602039337158, 0.44680285453796387, 0.44672495126724243, 0.44881874322891235, 0.45262357592582703, 0.45514440536499023, 0.45616120100021362, 0.45776408910751343, 0.45964595675468445, 0.46004757285118103, 0.45997601747512817, 0.4614444375038147, 0.46291205286979675, 0.46496793627738953, 0.46412283182144165, 0.46386030316352844, 0.46702030301094055, 0.46874597668647766, 0.46910753846168518, 0.46995952725410461, 0.47110563516616821, 0.47185179591178894, 0.47159776091575623, 0.47146210074424744, 0.47212478518486023, 0.47311732172966003, 0.47462022304534912, 0.47701254487037659, 0.4780832827091217, 0.47687652707099915, 0.4746326208114624, 0.47800204157829285, 0.47972175478935242, 0.4804685115814209, 0.48002558946609497, 0.47986388206481934, 0.47804740071296692, 0.48024740815162659, 0.48223677277565002, 0.48410865664482117, 0.48436683416366577, 0.48413744568824768, 0.48095792531967163], 'loss': [0.17862743201287135, 0.17391774107305269, 0.16966642463847031, 0.16468542112447607, 0.16173148269460078, 0.1586016241587527, 0.15599337716353293, 0.15375509786318584, 0.15142806538616319, 0.14843863983274419, 0.14802981709076043, 0.14531069300326174, 0.14244483951540401, 0.14085329541893674, 0.1396478142952475, 0.13906906729590593, 0.13804994122026262, 0.1380833522187136, 0.13678563241760153, 0.13450281891608681, 0.13364226042179783, 0.1326845749837284, 0.13182270406109872, 0.1324625884193972, 0.13155180522672189, 0.13365375305253599, 0.12920385816206936, 0.12896666076005744, 0.12969586497982646, 0.12729967237824547, 0.12871718933848666, 0.12984219162448474, 0.12737157359833523, 0.12697334739360203, 0.12675045805229415, 0.1227523357590083, 0.12681985342097832, 0.12541680046135859, 0.1260364938278449, 0.12180368209753475, 0.12466300771799171, 0.12257489007117323, 0.12224760455735281, 0.12090998231907664, 0.12069808010334253, 0.12104497890743995, 0.11993824162592893, 0.12143788667067248, 0.11992326757471768, 0.11940822537339661, 0.11984192750540125, 0.1194842701200457, 0.11891244872506843, 0.11595665092242377, 0.11989169891797177, 0.11764280428663142, 0.11702503154599, 0.11457958503300886, 0.1163359848050011, 0.11897204092500765, 0.11430190366500048, 0.11768722013536706, 0.11632775672000444, 0.1151187642837537], 'cos': [0.033754250346830876, 0.15722718324026691, 0.23560906905856346, 0.33603519540757498, 0.39697125374552716, 0.43772644222370244, 0.45344592106955989, 0.46490811603092808, 0.47228131530579964, 0.4885962329323425, 0.48647754809942589, 0.50545534984436113, 0.5177972167893542, 0.52366144715238117, 0.53844506566913597, 0.53034953356833736, 0.53498575212138111, 0.52920607166509637, 0.53553511331272019, 0.54523511333768493, 0.55315550851665218, 0.55927667344909116, 0.56013450225629524, 0.55932054018269228, 0.56383062701627429, 0.54296509191997733, 0.57236163815950647, 0.57351679073367168, 0.56951032130114998, 0.58137483932363498, 0.56889186115672263, 0.56469336155340943, 0.57853596560404053, 0.58126593830812667, 0.58335504441767894, 0.6082807493366521, 0.58292238291879339, 0.59066904133016418, 0.58536779469232048, 0.6095624589580565, 0.59463060790058819, 0.60736580171825327, 0.6069761948804866, 0.61390645656763265, 0.61979581414021123, 0.61525724914745072, 0.62447635060725049, 0.61344995255799306, 0.62168080006345605, 0.6237687422176833, 0.62036759607893743, 0.61831713342979988, 0.62509819117720522, 0.641174014139541, 0.61504523536070022, 0.62574541914763349, 0.63515679598638031, 0.64815916380511451, 0.63731300295509097, 0.62148423452105739, 0.64932106430402592, 0.62451575130126302, 0.63490514830978917, 0.63794207057190355]}
last_val_loss=dict_last['val_loss']


print (len(new_val_loss))
plt.plot()
x1=range(1,21)#15 not in 
x2=range(1,65)
x3=range(1,36)

plt.plot(x1,new_val_loss) 
plt.plot(x2,last_val_loss)
plt.plot(x3,full_val_loss) 
plt.axvline(x=14,color='blue', linestyle='dashed')
plt.axvline(x=58,color='orange', linestyle='dashed')
plt.axvline(x=29,color='green', linestyle='dashed')

plt.title('val_loss vs epoch')  
plt.ylabel('val_loss')  
plt.xlabel('epoch')  
plt.legend(['_New', '_Last','_Full'], loc='upper left')  #,'train_cos','val_cos'
plt.show() 


plt.plot()
new1=[0.1061,0.1019,0.0997,0.1024,0.1023]
last1=[0.1352,0.1402,0.1382,0.1387,0.1379]
full1=[0.1052,0.0996,0.0886,0.0923,0.0913]
x=[0.0,0.2,0.3,0.4,0.5]
plt.plot(x,new1,marker='o',color='blue')
plt.plot(x,last1,marker='o',color='orange')
plt.plot(x,full1,marker='o',color='green')
plt.legend(['_New', '_Last','_Full'], loc='upper left')
plt.show()


plt.plot()
new1=[0.1061,0.0997,0.1,0.1032,0.1023]
last1=[0.1352,0.1402,0.1382,0.1387,0.1379]
full1=[0.1047,0.0886,0.0931,0.0914,0.0899]
x=[0.0,0.2,0.3,0.4,0.5]
plt.plot(x,new1,marker='o',color='blue')
plt.plot(x,last1,marker='o',color='orange')
plt.plot(x,full1,marker='o',color='green')
plt.legend(['_New', '_Last','_Full'], loc='upper left')
plt.show()
