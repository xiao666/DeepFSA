import numpy as np
import matplotlib.pyplot as plt



#chain-thaw
dict_last={'val_loss': [0.19044181734869775, 0.18411831712528548, 0.17908576883512214, 0.17439959600355379, 0.17066270040154699, 0.1676928499322802, 0.16487871787213015, 0.16234787078593269, 0.16015535101385564, 0.15834092632573393, 0.15684552457327755, 0.15563940777312471, 0.15389913745421741, 0.15264729818598557, 0.1515473079414329, 0.15068769248585595, 0.14975415215715615, 0.14859374295426969, 0.14779118777778144, 0.14732063205081916, 0.14693783675823094, 0.14592286313138522, 0.14518499762851692, 0.14480318277770779, 0.14447597306517623, 0.14367646385598815, 0.14307062901450271, 0.14260877034571895, 0.14226312240369451, 0.14231026548960543, 0.14131048036447125, 0.14097053674476454, 0.14114649360145912, 0.14075762701131661, 0.13999707447535636, 0.1396595284555206, 0.13936549206615223, 0.13915589281837712, 0.13903146259896382, 0.13877371912575545, 0.13823333151957168, 0.13794401099871229, 0.13774709291225051, 0.13768028836629057, 0.1373610212458127, 0.1371440569397874, 0.13702000371064771, 0.13736339359565083, 0.13664034767694727, 0.13651097361036327, 0.1364055861038006, 0.13632236381655069, 0.13610113255846526, 0.13585901964463429, 0.13567297667447029, 0.13566258762130426, 0.13535797856975718, 0.13533688975448763], 'val_cos': [0.070382337489918387, 0.24635995851636175, 0.33066368030190713, 0.41589620739767846, 0.44013975642606346, 0.43746585552172845, 0.45230417387548627, 0.46549819115465868, 0.47524045471504117, 0.47925124901618105, 0.48172775141576157, 0.48332876980668898, 0.49641071384404684, 0.50300382997256432, 0.50451837804798194, 0.50573545075239812, 0.50944831724565043, 0.51789120701568436, 0.52082480147268528, 0.51976563834609912, 0.51956134239427909, 0.52610568559582516, 0.53089698669623941, 0.53117625169501526, 0.53144886076086162, 0.53688710053923661, 0.54035822922731858, 0.54220690613123157, 0.54300991896456463, 0.5407189191480275, 0.54792888805482631, 0.54948672743290361, 0.54633607337528234, 0.54839352192072666, 0.55386373576710035, 0.55574572329123006, 0.55697297297281545, 0.55700834899715879, 0.5568252103877408, 0.55784345874961183, 0.56144093374613591, 0.56294814911490787, 0.56322601662148286, 0.56283924365966242, 0.56467208648650569, 0.5660444302617168, 0.56595859253236569, 0.56275184540544654, 0.56757984712507481, 0.56828171694594343, 0.5682110271725781, 0.56824249004880667, 0.56929336036052824, 0.57075400532141718, 0.57169180902104266, 0.57132522018281118, 0.57322216349560962, 0.5728623438512721], 'loss': [0.17832296262062994, 0.17102775525712716, 0.16495523028949932, 0.16004130390396051, 0.15541192148069993, 0.15197083787199911, 0.14829143479910081, 0.1454557696334535, 0.14292770838152924, 0.14061182909588055, 0.13852876552662791, 0.1370065488873764, 0.13502618733095412, 0.13378626037708724, 0.13245752422488091, 0.13097000197750466, 0.12982288676260231, 0.12862192848517889, 0.12767012626089272, 0.12651776309710669, 0.12572631756603822, 0.12481979263747428, 0.12407124340012278, 0.12308537370269228, 0.12229840666212259, 0.12148045113019894, 0.12074399601191857, 0.12008827768148767, 0.11934082095238874, 0.11877703163022545, 0.11841935045925832, 0.11752008534511209, 0.11674879398686247, 0.11641821072105768, 0.11564817454424506, 0.11501763638389507, 0.11454136734877284, 0.11395996315779912, 0.11336105251635854, 0.11292418765781639, 0.11230527814445061, 0.11186117924188774, 0.11134945838704001, 0.11083317998203003, 0.11033429639926098, 0.10994016431311175, 0.10940994627630231, 0.10930745060932406, 0.10849644950935176, 0.10817511999513138, 0.10762223798370611, 0.10714019862396705, 0.10671444443395384, 0.10626824121863537, 0.10587413778655792, 0.10548107716174969, 0.10515668082675667, 0.104673727498685], 'cos': [-0.051623943716861735, 0.18970275687252786, 0.33291630533029654, 0.42399226423946657, 0.47343636634262137, 0.47969219229476046, 0.49038796411295488, 0.50740604470573669, 0.51929316545743653, 0.53044496066933544, 0.53114443077932516, 0.53360335124353186, 0.54401705509309384, 0.55559242147489107, 0.55991793555678926, 0.56264804321913708, 0.56749913080769954, 0.57159454079308991, 0.57987069060631269, 0.5858077827560505, 0.58582741283076034, 0.59058711919183282, 0.59537921227423407, 0.60166186125599985, 0.60026575126497628, 0.60772987171981463, 0.61216224669992614, 0.61677557960700657, 0.62078914281156983, 0.62056302878151004, 0.62018270949766219, 0.62878583034993052, 0.63262597243130314, 0.63158099611669827, 0.63435409678677956, 0.64257797061248756, 0.64478518415875274, 0.64728553689716162, 0.64798857086385397, 0.64950575667797161, 0.65482301553368782, 0.65715632881258079, 0.65857770804139648, 0.66179457071992431, 0.66209082720367374, 0.66609506139404506, 0.66669593780136771, 0.66799951142479785, 0.66933268715746552, 0.67536304189110807, 0.6791297159762808, 0.68050861880574665, 0.67973515688851083, 0.6826569363866295, 0.6854897662344831, 0.68515019408458167, 0.68815764957050518, 0.69181276526426061]}

dict_embed={'val_loss': [0.12723373413814304, 0.12025957953662833, 0.11479932300427781, 0.111185637228722, 0.10869022543767805, 0.10712051827103931, 0.10585038330550106, 0.10494947682330176, 0.10426924837461071, 0.10404904280806268, 0.10395721314273881, 0.10395540747708069, 0.10395371469302964, 0.10398254173289977, 0.10403800960592242], 'val_cos': [0.61039308957801086, 0.63745274089747195, 0.65631527558363623, 0.66696770674342298, 0.67339578726141125, 0.67634619617656389, 0.67855578806638228, 0.67975009920155205, 0.68042164264045757, 0.67950575062796448, 0.67812680081291743, 0.67662028977438782, 0.67583308164068245, 0.67519010922088152, 0.67449886444387031], 'loss': [0.11510351305458884, 0.098712450033624624, 0.081721243254461978, 0.073021158406383735, 0.062339411451499224, 0.056101703249740099, 0.049233130967136857, 0.045317146894497548, 0.04168726809831718, 0.039494497691739461, 0.035234852359612226, 0.034930702631611334, 0.031891643648702922, 0.029018735721863923, 0.028597018908180831], 'cos': [0.6257861259731019, 0.70765466604466609, 0.7772858108405265, 0.80446501757342848, 0.84108201666178928, 0.86017642526409466, 0.88148948503250413, 0.89123936198429965, 0.90142773329272163, 0.90481489051244302, 0.9187532214483739, 0.91743955741621774, 0.92591806969584178, 0.93410996088004572, 0.93344659135137042]}
dict_lstm_0={'val_loss': [0.1037731179758876, 0.10458747872631322, 0.10442540155773007], 'val_cos': [0.67765832262952075, 0.67699954029013332, 0.67848941179982514], 'loss': [0.031914198996202334, 0.030993698977077488, 0.028741238126612795], 'cos': [0.92428163993588264, 0.92718786721471724, 0.93512268179143576]}
dict_lstm_1={'val_loss': [0.10403534272294909, 0.10378760049335825, 0.1042263333338584, 0.1038703114977922], 'val_cos': [0.67903195367082803, 0.67947878189339417, 0.67755656560423905, 0.67851970406996498], 'loss': [0.030058431006876683, 0.029155998228153707, 0.030084520898067804, 0.027771696383084601], 'cos': [0.93065413117617524, 0.93398590148434746, 0.93079976787082785, 0.93805465723294923]}
dict_att={'val_loss': [0.10385980759036031, 0.10392854239814393, 0.10399822632795439], 'val_cos': [0.67916953418016923, 0.67904367332788684, 0.67893873431289264], 'loss': [0.028105590120610337, 0.029172731941849672, 0.028070437198344962], 'cos': [0.93741851418740696, 0.93263976690856876, 0.93727469256379348]}

dict_all={'val_loss': [0.10399214493949156, 0.10403745653308821, 0.10405255587062136], 'val_cos': [0.67850767170096127, 0.67823828699146904, 0.67805729172137508], 'loss': [0.029216832401403822, 0.028647189829400666, 0.027772885637974365], 'cos': [0.93353500435105974, 0.93538706294291907, 0.93794019815174379]}



train_loss=dict_last['loss']+dict_embed['loss']+dict_lstm_0['loss']+dict_lstm_1['loss']+dict_att['loss']+dict_all['loss']
val_loss=dict_last['val_loss']+dict_embed['val_loss']+dict_lstm_0['val_loss']+dict_lstm_1['val_loss']+dict_att['val_loss']+dict_all['val_loss']
train_cos=dict_last['cos']+dict_embed['cos']+dict_lstm_0['cos']+dict_lstm_1['cos']+dict_att['cos']+dict_all['cos']
val_cos=dict_last['val_cos']+dict_embed['val_cos']+dict_lstm_0['val_cos']+dict_lstm_1['val_cos']+dict_att['val_cos']+dict_all['val_cos']
epochs=[58,15,3,4,3,3]
print (len(dict_last['loss']))

print (len(train_loss))
plt.plot()
#86
x=range(1,87)

plt.plot(x,train_loss) 
plt.plot(x,val_loss)
plt.plot(x,train_cos) 
plt.plot(x,val_cos) 
plt.axvline(x=58,color='black', linestyle='dashed')
plt.axvline(x=73,color='black', linestyle='dashed')
plt.axvline(x=76,color='black', linestyle='dashed')
plt.axvline(x=80,color='black', linestyle='dashed')
plt.axvline(x=83,color='black', linestyle='dashed')


plt.title('loss(cos) vs epoch (Emoji_)')  
plt.ylabel('loss(cos)')  
plt.xlabel('epoch')  
plt.legend(['train_loss', 'test_loss','train_WCS','test_WCS'], loc='upper left')  #,'train_cos','val_cos'
plt.show() 
